# NodeJS SDK Subscription example

In this example you will learn how to query the chain of transactions and messages (so-called "Transaction tree"), generated by one message with [query_transaction_tree function](https://github.com/tonlabs/TON-SDK/blob/master/docs/mod_net.md#query_transaction_tree).

We will pick one external inbound message to a multisig contract with 'sendTransaction' call and retrieve the transaction tree from it to make sure the internal message with value transfer was delivered. 

In the example we use [TON OS SE](https://docs.ton.dev/86757ecb2/p/19d886-ton-os-se), local blockchain.

## Prerequisite

* Node.js >= [14.x installed](https://nodejs.org)
* [Docker](https://docs.docker.com/desktop/#download-and-install)
* [TONDEV CLI](https://docs.ton.dev/86757ecb2/p/179e51-tondev)


## Preparation

* [Run TON OS SE on your computer](https://docs.ton.dev/86757ecb2/p/19d886-ton-os-se) 

```sh
tondev se start
```

You're all set! Check out the TON OS SE GraphQL web playground at http://0.0.0.0/graphql. For Windows, use http://127.0.0.1/graphql or http://localhost/graphql. Learn more about GraphQL API here.

See other available [TON OS SE management options in TONDEV](https://docs.ton.dev/86757ecb2/v/0/p/54722f-ton-os-se).

## Install packages & run:

```sh
npm install
node index.js
```
## Result
As you can see from the result, we have an internal message in the list of messages with value transfer,
which means the transfer was successfull. 
Here we do not pay attention to the aborted status of the deposit transaction because the message was sent to the account that was not yet deployed (exit_code=null).
```sh
Query params: {
  in_msg: '9add67505ac1cb530414ad6c3979865475722f25506c364df3a9a5c71c93e5ec',
  abi: {
    type: 'Contract',
    value: '/Users/ekaterina/Study/sdk-samples/low-level/node-js/core-api/query_transaction_tree/SafeMultisigWallet.abi.json'
  }
}
[
  {
    id: '9add67505ac1cb530414ad6c3979865475722f25506c364df3a9a5c71c93e5ec',
    src_transaction_id: null,
    dst_transaction_id: '42f5a961469da0cf731ca51c3922e62a45c397b200b1e8ce2811a02cdb84c8d5',
    src: '',
    dst: '0:acad9bed05bbf1223de0c9c7865d5f34d488487e941f76e888b19640ced190cf',
    value: null,
    bounce: false,
    decoded_body: null
  },
  {
    id: '649f010559be35837dd3b8a5b5c5bac8f686d5cfa1d1f69099b38b46198c372d',
    src_transaction_id: '42f5a961469da0cf731ca51c3922e62a45c397b200b1e8ce2811a02cdb84c8d5',
    dst_transaction_id: 'c7aa83c5a9210b6424938ad9b91253387a250c7523e08d1227faf5814301712b',
    src: '0:acad9bed05bbf1223de0c9c7865d5f34d488487e941f76e888b19640ced190cf',
    dst: '0:97e086dfbbeb725f76f3bd25e9e68952a11f40e256f6ff65fe62269fd6334c41',
    value: '0x4a817c800',
    bounce: false,
    decoded_body: null
  }
]
[
  {
    id: '42f5a961469da0cf731ca51c3922e62a45c397b200b1e8ce2811a02cdb84c8d5',
    in_msg: '9add67505ac1cb530414ad6c3979865475722f25506c364df3a9a5c71c93e5ec',
    out_msgs: [
      '649f010559be35837dd3b8a5b5c5bac8f686d5cfa1d1f69099b38b46198c372d'
    ],
    account_addr: '0:acad9bed05bbf1223de0c9c7865d5f34d488487e941f76e888b19640ced190cf',
    total_fees: '0xaa5c76',
    aborted: false,
    exit_code: 0
  },
  {
    id: 'c7aa83c5a9210b6424938ad9b91253387a250c7523e08d1227faf5814301712b',
    in_msg: '649f010559be35837dd3b8a5b5c5bac8f686d5cfa1d1f69099b38b46198c372d',
    out_msgs: [],
    account_addr: '0:97e086dfbbeb725f76f3bd25e9e68952a11f40e256f6ff65fe62269fd6334c41',
    total_fees: '0x0',
    aborted: true,
    exit_code: null
  }
]
```